<div class="panel-heading">
    <div class="panel-title">
        <h3 class="panel-title">
            <label class="label label-primary panel-title__label" style="width: 110px">{{productLabel(item)}}</label>
            <button class="btn btn-link remove-padding panel-title__link"
                    (click)="viewProductInfo(item)"
                    [disabled]="!canViewDetailed">
                {{item.productName | ellipsis:20}}
            </button>
            <div class="pull-right panel-title__flex-space">
                <a class="btn badge btn-rounded push-15-r panel-title__influential"
                   [ngClass]="{'disabled': !canRemove,'panel-title__influential-active': item.highlightFlag==1}"
                   (click)="updateHighlightFlag()">有力
                </a>
                <span class="panel-title__date panel-title__date_label">更新日</span>
                <span class="panel-title__date panel-title__date_strong">{{item.getUpdatedDate()}}</span>
            </div>
            <a role="button" data-toggle="collapse" class="pull-right accordion-toggle" href="#panelProduct{{item.id}}"
               aria-expanded="true">
                <i class="glyphicon glyphicon-chevron-down"></i>
            </a>
        </h3>
    </div>
</div>
<div class="panel-collapse collapse in" id="panelProduct{{item.id}}">
    <div class="panel-body block panel-body--has-tab_block">
        <ul class="nav nav-tabs nav-tabs-alt">
            <li class="active">
                <a href="#panelProduct{{item.id}}_basic" data-toggle="tab">基本情報</a>
            </li>
            <li>
                <a href="#panelProduct{{item.id}}_stock" data-toggle="tab">取引実績・在庫数</a>
            </li>
            <li class="pull-right">
                <div class="block-options-simple">
                    <button class="btn btn-link text-danger"
                            (click)="detachMe()"
                            [disabled]="!canRemove">切り離す
                    </button>
                    <button class="btn btn-link"
                            (click)="viewProductInfo()"
                            [disabled]="!canViewDetailed">詳細
                    </button>
                </div>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane tab-pane--default active" id="panelProduct{{item.id}}_basic">
                <div class="row">
                    <div class="col-sm-3 panel-body__thumb">
                        <file-viewer [srcFile]="item.srcImg"></file-viewer>
                    </div>
                    <div class="col-sm-9">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-condensed">
                                        <tbody>
                                        <tr>
                                            <th style="width: 20%">製品ID</th>
                                            <td style="width: 20%">{{item.productCode}}</td>
                                            <th style="width: 30%">製造依頼先</th>
                                            <td style="width: 30%">{{item.getFactory()}}</td>
                                        </tr>
                                        <tr>
                                            <th>製品名</th>
                                            <td colspan="3">{{item.productName | ellipsis:25}}</td>
                                        </tr>
                                        <tr>
                                            <th>サイズ</th>
                                            <td colspan="3">{{item.getDimension()}}</td>
                                        </tr>
                                        <tr>
                                            <th>材料</th>
                                            <td colspan="3">{{getPaperName(item)}}</td>
                                        </tr>
                                        <tr>
                                            <th>木型ID</th>
                                            <td colspan="3">{{item.woodenCode}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-condensed">
                                        <tbody class="has-strong-top-border">
                                        <tr>
                                            <th style="width: 20%">メモ</th>
                                            <td style="width: 80%">
                                                <div class="block-with-text">{{item.memo}}</div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane tab-pane--stock" id="panelProduct{{item.id}}_stock">
                <!--<transaction-stock>-->
                <div class="row">
                    <div class="col-sm-7">
                        <div class="row push-10-t">
                            <div class="col-sm-10">
                                <span class="push-15-l">直近のお取引状況</span>
                            </div>
                            <div class="col-sm-2">
                                <button type="button" class="btn btn-link remove-padding" disabled>詳細</button>
                            </div>
                        </div>

                        <div class="row push-10-t">
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-striped table-condensed">
                                        <thead>
                                        <tr>
                                            <th>日付</th>
                                            <th>案件名</th>
                                            <th>注文数</th>
                                            <th>単価</th>
                                            <th>金額</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr *ngFor="let orderItem of orderItems">
                                            <td>{{orderItem.updatedDate| date:'yyyy/MM/dd'}}</td>
                                            <td>{{deal.dealName | ellipsis: 20}}</td>
                                            <td>{{orderItem.quantity == undefined?'':(orderItem.quantity |
                                                numberFormat) + ' ロット'}}
                                            </td>
                                            <td>{{orderItem.submittedPrice ==
                                                undefined?'':'@'+orderItem.submittedPrice}}
                                            </td>
                                            <td>{{orderItem.total==undefined?'':orderItem.total+'円'}}</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-5">
                        <div class="row push-10-t">
                            <div class="col-sm-10">
                                <span class="push-15-l">在庫リスト</span>
                            </div>
                            <div class="col-sm-2">
                                <button type="button" class="btn btn-link remove-padding" disabled>詳細</button>
                            </div>
                        </div>

                        <div class="row push-10-t">
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table class="table table-striped table-condensed">
                                        <thead>
                                        <tr>
                                            <th>製品名</th>
                                            <th>在庫数</th>
                                            <th>単価</th>
                                            <th>日数</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr *ngFor="let orderItem of orderItems">
                                            <td>{{item.productName | ellipsis: 20}}</td>
                                            <td>{{item.quantityStock | numberFormat}}</td>
                                            <td>{{item.estimatedUnitPrice | number : '1.2-2'}}</td>
                                            <td>{{countDelayDate(orderItem)}}日</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
